import{r as c,j as e,B as N,m as z,e as M,t as r}from"./index-Vk1JcykI.js";import{A as _,M as v}from"./AdminModal-C6SQEGRx.js";import{A}from"./AdminPagination-CvF16Uu8.js";import{I as P}from"./IconPlus-ClLJlg6j.js";import{I as E}from"./IconEdit-BObYIa1A.js";import{I as D}from"./IconTrash-CKOA_JOc.js";import{x as B,y as F,z as T,A as U}from"./contest-gOalgBZp.js";import"./IconX-Q1H3aBc3.js";import"./createReactComponent-DZMLdy9T.js";function H({notices:i=[],totalCount:p=0,currentPage:g=1,pageSize:f=10,onPageChange:j,onCreateNotice:m,onUpdateNotice:b,onDeleteNotice:u}){const[d,l]=c.useState(!1),[o,x]=c.useState("create"),[s,n]=c.useState(null),[a,h]=c.useState({title:"",content:"",type:""}),k=()=>{x("create"),h({title:"",content:"",type:"normal"}),l(!0)},w=t=>{x("edit"),n(t),h({title:t.title,content:t.content,type:t.type}),l(!0)},y=t=>{x("delete"),n(t),l(!0)},C=()=>{o==="create"?m(a):o==="edit"?b(s.id,a):u(s.id),l(!1)},I=()=>o==="delete"?e.jsxs("p",{className:"text-neutral-300",children:['确定要删除公告 "',s==null?void 0:s.title,'" 吗？此操作不可恢复。']}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-mono text-neutral-400 mb-2",children:"公告标题"}),e.jsx("input",{type:"text",value:a.title,onChange:t=>h({...a,title:t.target.value}),placeholder:"请输入公告标题",className:`w-full h-[40px] px-4 bg-black/20 border border-neutral-300/30 rounded-md\r
                            text-neutral-50 placeholder-neutral-500\r
                            focus:outline-none focus:border-geek-400 focus:shadow-[0_0_15px_rgba(89,126,247,0.3)]\r
                            transition-all duration-200`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-mono text-neutral-400 mb-2",children:"公告类型"}),e.jsxs("select",{value:a.type,onChange:t=>h({...a,type:t.target.value}),className:`w-full h-[40px] px-4 bg-black/20 border border-neutral-300/30 rounded-md\r
                            text-neutral-50\r
                            focus:outline-none focus:border-geek-400 focus:shadow-[0_0_15px_rgba(89,126,247,0.3)]\r
                            transition-all duration-200`,children:[e.jsx("option",{value:"normal",className:"bg-black/90 text-neutral-50",children:"normal"}),e.jsx("option",{value:"important",className:"bg-black/90 text-neutral-50",children:"important"}),e.jsx("option",{value:"update",className:"bg-black/90 text-neutral-50",children:"update"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-mono text-neutral-400 mb-2",children:"公告内容"}),e.jsx("textarea",{value:a.content,onChange:t=>h({...a,content:t.target.value}),placeholder:"请输入公告内容",rows:5,className:`w-full p-4 bg-black/20 border border-neutral-300/30 rounded-md\r
                            text-neutral-50 placeholder-neutral-500\r
                            focus:outline-none focus:border-geek-400 focus:shadow-[0_0_15px_rgba(89,126,247,0.3)]\r
                            transition-all duration-200 resize-none`})]})]}),S=()=>e.jsxs(e.Fragment,{children:[e.jsx(v,{onClick:()=>l(!1),children:"取消"}),e.jsx(v,{variant:o==="delete"?"danger":"primary",onClick:C,children:"确认"})]});return e.jsxs("div",{className:"w-full max-w-[1200px] mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-mono text-neutral-50 tracking-wider",children:"公告管理"}),e.jsx(N,{variant:"primary",size:"sm",align:"icon-left",icon:e.jsx(P,{size:18}),onClick:k,children:"发布公告"})]}),e.jsx("div",{className:"border border-neutral-300 rounded-md bg-black/30 backdrop-blur-[2px] overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-black/50 text-left",children:[e.jsx("th",{className:"p-4 text-neutral-400 font-mono",children:"ID"}),e.jsx("th",{className:"p-4 text-neutral-400 font-mono",children:"标题"}),e.jsx("th",{className:"p-4 text-neutral-400 font-mono",children:"类型"}),e.jsx("th",{className:"p-4 text-neutral-400 font-mono",children:"内容"}),e.jsx("th",{className:"p-4 text-neutral-400 font-mono text-right",children:"操作"})]})}),e.jsx("tbody",{children:i.map(t=>e.jsxs(z.tr,{className:"border-t border-neutral-700 hover:bg-black/20",whileHover:{backgroundColor:"rgba(0,0,0,0.3)"},children:[e.jsx("td",{className:"p-4 text-neutral-300 font-mono",children:t.id}),e.jsx("td",{className:"p-4 text-neutral-50 font-medium",children:t.title}),e.jsx("td",{className:"p-4 text-neutral-300 font-medium",children:t.type}),e.jsx("td",{className:"p-4 text-neutral-300",children:e.jsx("div",{className:"max-w-lg truncate",children:t.content})}),e.jsx("td",{className:"p-4 text-right",children:e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(N,{variant:"ghost",size:"icon",className:"!text-geek-400 hover:!text-geek-300",onClick:()=>w(t),children:e.jsx(E,{size:18})}),e.jsx(N,{variant:"ghost",size:"icon",className:"!text-red-400 hover:!text-red-300",onClick:()=>y(t),children:e.jsx(D,{size:18})})]})})]},t.id))})]})})}),e.jsx("div",{className:"mt-6",children:e.jsx(A,{total:Math.ceil(p/f),current:g,pageSize:f,onChange:j,showTotal:!0,totalItems:p})}),e.jsx(_,{isOpen:d,onClose:()=>l(!1),title:o==="create"?"发布公告":o==="edit"?"编辑公告":"删除公告",size:o==="delete"?"sm":"md",footer:S(),children:I()})]})}function W(){const{id:i}=M(),[p,g]=c.useState([]),[f,j]=c.useState(0),[m,b]=c.useState(1),u=10;c.useEffect(()=>{d()},[i,m]);const d=async()=>{try{const s=await B(parseInt(i),{limit:u,offset:(m-1)*u});s.code===200?(g(s.data.notices),j(s.data.count)):r.danger({description:s.msg||"获取公告列表失败"})}catch(s){console.error("获取公告列表失败:",s),r.danger({description:"获取公告列表失败"})}},l=async s=>{try{const n=await F(parseInt(i),s);n.code===200?(r.success({description:"创建公告成功"}),d()):r.danger({description:n.msg||"创建公告失败"})}catch(n){console.error("创建公告失败:",n),r.danger({description:"创建公告失败"})}},o=async(s,n)=>{try{const a=await T(parseInt(i),s,n);a.code===200?(r.success({description:"更新公告成功"}),d()):r.danger({description:a.msg||"更新公告失败"})}catch(a){console.error("更新公告失败:",a),r.danger({description:"更新公告失败"})}},x=async s=>{try{const n=await U(parseInt(i),s);n.code===200?(r.success({description:"删除公告成功"}),d()):r.danger({description:n.msg||"删除公告失败"})}catch(n){console.error("删除公告失败:",n),r.danger({description:"删除公告失败"})}};return e.jsx(H,{notices:p,totalCount:f,currentPage:m,pageSize:u,onPageChange:b,onCreateNotice:l,onUpdateNotice:o,onDeleteNotice:x})}export{W as default};
