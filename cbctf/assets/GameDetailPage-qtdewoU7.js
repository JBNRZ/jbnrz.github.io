import{r as c,j as e,m as a,B as h,e as p,u as g,L as f,t as v}from"./index-zkf441mv.js";import{a as b}from"./contest-CZvV6DDf.js";function j({contest:t,handleJoinContest:l}){var m,x,i;const[r,o]=c.useState(null),[d,u]=c.useState(null);return t?e.jsxs("div",{className:"w-full max-w-[1200px] mx-auto space-y-6",children:[e.jsxs(a.div,{className:"relative w-full h-[300px] border border-neutral-300 rounded-md overflow-hidden bg-black/30 backdrop-blur-[2px]",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[e.jsx("div",{className:"absolute inset-0 opacity-30",style:{backgroundImage:`url(${t.image})`,backgroundSize:"cover",backgroundPosition:"center"}}),e.jsxs("div",{className:"relative h-full p-8 flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("h1",{className:"text-4xl font-mono text-neutral-50 tracking-wider",children:t.title}),e.jsx("span",{className:`px-3 py-1 border rounded-md text-sm ${t.status==="upcoming"?"text-yellow-400 border-yellow-400":t.status==="active"?"text-green-400 border-green-400":"text-neutral-400 border-neutral-400"}`,children:t.status.toUpperCase()})]}),e.jsx("p",{className:"text-neutral-300 max-w-[800px] text-lg",children:t.description})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex gap-8",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-neutral-400",children:"Start Time"}),e.jsx("div",{className:"text-neutral-50 font-mono",children:new Date(t.startTime).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-neutral-400",children:"End Time"}),e.jsx("div",{className:"text-neutral-50 font-mono",children:new Date(t.endTime).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-neutral-400",children:"Participants"}),e.jsx("div",{className:"text-neutral-50 font-mono",children:t.participants||0})]})]}),e.jsx(h,{variant:"primary",size:"lg",disabled:t.status==="ended",onClick:l,children:t.status==="upcoming"||t.status==="active"?"JOIN CONTEST":"CONTEST ENDED"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[e.jsxs(a.div,{className:"col-span-2 border border-neutral-300 rounded-md bg-black/30 backdrop-blur-[2px] p-8",children:[e.jsx("h2",{className:"text-2xl font-mono text-neutral-50 tracking-wider mb-6",children:"Contest Rules"}),e.jsx("div",{className:"space-y-4 text-neutral-300",children:(m=t.rules)==null?void 0:m.map((n,s)=>e.jsxs(a.div,{className:"flex gap-4 p-2 rounded-md hover:bg-neutral-300/5 transition-colors duration-200 cursor-default",whileHover:{x:10},children:[e.jsx("span",{className:"text-geek-400 font-mono",children:(s+1).toString().padStart(2,"0")}),e.jsx("p",{children:n})]},s))})]}),e.jsxs(a.div,{className:"border border-neutral-300 rounded-md bg-black/30 backdrop-blur-[2px] p-8",children:[e.jsx("h2",{className:"text-2xl font-mono text-neutral-50 tracking-wider mb-6",children:"Prizes"}),e.jsx("div",{className:"space-y-6",children:(x=t.prizes)==null?void 0:x.map((n,s)=>e.jsxs(a.div,{className:`group p-4 rounded-md transition-all duration-200 cursor-default
                                    ${r===s?"bg-neutral-300/5":"hover:bg-neutral-300/5"}`,onMouseEnter:()=>o(s),onMouseLeave:()=>o(null),whileHover:{scale:1.02},children:[e.jsxs(a.div,{className:"flex items-center gap-3 text-neutral-50 mb-2",animate:{x:r===s?10:0,transition:{duration:.2}},children:[e.jsx("span",{className:`text-lg font-mono
                                        ${s===0?"text-yellow-400":s===1?"text-neutral-300":s===2?"text-orange-400":"text-neutral-400"}
                                    `,children:s===0?"1ST":s===1?"2ND":s===2?"3RD":`${s+1}TH`}),e.jsx("span",{className:"text-xl font-mono",children:n.amount})]}),e.jsx(a.p,{className:"text-neutral-400 text-sm",animate:{x:r===s?10:0,transition:{duration:.2,delay:.1}},children:n.desc})]},s))})]})]}),e.jsxs(a.div,{className:"border border-neutral-300 rounded-md bg-black/30 backdrop-blur-[2px] p-8",children:[e.jsx("h2",{className:"text-2xl font-mono text-neutral-50 tracking-wider mb-6",children:"Timeline"}),e.jsxs("div",{className:"relative flex items-start gap-8",children:[e.jsx("div",{className:"absolute top-[30px] left-0 right-0 h-[2px] bg-neutral-300/20"}),(i=t.timeline)==null?void 0:i.map((n,s)=>e.jsx(a.div,{className:`flex-1 relative p-4 rounded-md transition-all duration-200 cursor-default
                                ${d===s?"bg-neutral-300/5":"hover:bg-neutral-300/5"}`,onMouseEnter:()=>u(s),onMouseLeave:()=>u(null),children:e.jsxs(a.div,{animate:{y:d===s?-5:0,transition:{duration:.2}},className:"border-none",children:[e.jsx("div",{className:"text-geek-400 font-mono mb-2",children:new Date(n.date).toISOString().slice(0,10)}),e.jsx("div",{className:"text-neutral-50 font-mono mb-1",children:n.title}),e.jsx("div",{className:"text-neutral-400 text-sm",children:n.desc})]})},s))]})]})]}):null}const N=["参赛者必须遵守比赛规则和道德准则","禁止攻击比赛平台和其他参赛者","禁止分享题目答案和解题思路","每支队伍人数不得超过4人","比赛采用动态积分机制","设有First Blood奖励","违规行为将导致成绩作废"],w=[{amount:"¥10,000",description:"一等奖：现金奖励以及CBCTF定制纪念品"},{amount:"¥5,000",description:"二等奖：现金奖励以及精美礼品"},{amount:"¥3,000",description:"三等奖：现金奖励"}],T=[{date:"2024-02-15",title:"开放注册",description:"比赛平台开放注册，参赛者可以组队报名"},{date:"2024-02-16",title:"比赛开始",description:"题目公布，正式开始解题"},{date:"2024-02-17",title:"比赛结束",description:"停止计分，公布最终排名"},{date:"2024-02-18",title:"Writeup公布",description:"官方题解发布，选手交流分享"}],y=(t,l)=>{const r=new Date().getTime(),o=new Date(t).getTime(),d=o+l*1e3;return r<o?"upcoming":r>d?"ended":"active"},S=t=>{if(!t)return null;const l=new Date(t.start),r=new Date(l.getTime()+t.duration*1e3);return{title:`${t.prefix} ${t.name}`,description:t.desc,image:t.avatar||"https://images.unsplash.com/photo-1562813733-b31f71025d54?q=80&w=2069&auto=format&fit=crop",status:y(t.start,t.duration),startTime:l.toISOString(),endTime:r.toISOString(),participants:t.users||0,rules:t.rules||N,prizes:t.prizes||w,timeline:t.timelines||T,teamSize:t.size,teamsCount:t.teams,noticesCount:t.notices,isBlood:t.blood,isHidden:t.hidden}};function E(){const{contestId:t}=p(),[l,r]=c.useState(null),[o,d]=c.useState(!0),u=g(),m=()=>{u(`/contests/${t}/challenges`)};return c.useEffect(()=>{(async()=>{try{const i=await b(t);if(i.code===200){const n=S(i.data);r(n)}else throw new Error(i.msg||"获取比赛详情失败")}catch(i){v.danger({title:"获取比赛详情失败",description:i.message})}finally{d(!1)}})()},[t]),o?e.jsx(f,{}):e.jsx(j,{contest:l,handleJoinContest:m})}export{E as default};
