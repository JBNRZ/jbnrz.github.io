import{j as e,A as L,m as c,B as m,u as O,a as A,r as v,l as T,d as I,L as M,h as $,f as E,t as n,i as q,k as R,n as F,o as G}from"./index-Daxyzqv4.js";function S({isOpen:s,onClose:x,onConfirm:h,title:p,message:f,confirmText:w="CONFIRM",type:b="default"}){return e.jsx(L,{children:s&&e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center",children:[e.jsx(c.div,{className:"fixed inset-0 bg-black/60 backdrop-blur-sm",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:x}),e.jsxs(c.div,{className:"relative w-full max-w-[400px] m-4 p-6 border border-neutral-300 rounded-md bg-black/80",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},children:[e.jsx("h3",{className:"text-lg font-mono text-neutral-50 mb-4",children:p}),e.jsx("p",{className:"text-neutral-300 mb-6",children:f}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(m,{size:"sm",variant:"ghost",onClick:x,children:"CANCEL"}),e.jsx(m,{size:"sm",variant:b==="danger"?"danger":"primary",onClick:h,children:w})]})]})]})})}function H({user:s,onUpdate:x,onPasswordChange:h,onEmailVerify:p,onDeleteAccount:f,onAvatarChange:w}){const b=O(),j=A(),[r,o]=v.useState("profile"),[_,y]=v.useState(!1),[D,P]=v.useState(!1),[i,k]=v.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[t,g]=v.useState({currentPassword:"",newPassword:"",confirmPassword:""}),V=[{id:"profile",label:"Profile",icon:"👤"},{id:"security",label:"Security",icon:"🔒"},{id:"divider",type:"divider"},{id:"logout",label:"Logout",icon:"🖖",color:"text-red-400"}],N=a=>{const{name:d,value:l}=a.target;k(u=>({...u,[d]:l}))},C=a=>{const{name:d,value:l}=a.target;d==="newPassword"&&(l&&l.length<6?g(u=>({...u,newPassword:"Password must be at least 6 characters"})):g(u=>({...u,newPassword:""}))),d==="confirmPassword"&&i.newPassword&&g(u=>({...u,confirmPassword:l!==i.newPassword?"Passwords do not match":""}))},U=a=>{a.preventDefault();const d={currentPassword:i.currentPassword?"":"Current password is required",newPassword:i.newPassword.length<6?"Password must be at least 6 characters":"",confirmPassword:i.newPassword!==i.confirmPassword?"Passwords do not match":""};g(d),Object.values(d).some(l=>l)||(h(i),k({currentPassword:"",newPassword:"",confirmPassword:""}),g({currentPassword:"",newPassword:"",confirmPassword:""}))},z=()=>{const a=document.createElement("input");a.type="file",a.accept="image/*",a.onchange=d=>{const l=d.target.files[0];l&&w(l)},a.click()},B=()=>{b("/"),j(T())};return e.jsxs("div",{className:"w-full max-w-[1200px] mx-auto",children:[e.jsxs(c.div,{className:"border border-neutral-300 rounded-md bg-black/30 backdrop-blur-[2px] overflow-hidden",initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:[e.jsx("div",{className:"p-6 border-b border-neutral-300/30",children:e.jsx("h2",{className:"text-2xl font-mono text-neutral-50",children:"User Settings"})}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-[240px] border-r border-neutral-300/30 p-4",children:e.jsx("div",{className:"space-y-2",children:V.map(a=>a.type==="divider"?e.jsx("div",{className:"my-4 border-t border-neutral-300/30"},a.id):e.jsx(m,{variant:"ghost",align:"icon-left-text-center",icon:e.jsx("span",{className:"text-xl",children:a.icon}),textColor:a.id==="logout"?"text-red-400":r===a.id?"text-geek-400":"text-neutral-300",className:`w-full px-4 py-3 rounded-md min-w-0 h-auto
                      ${a.id==="logout"?"hover:bg-red-400/10":r===a.id?"bg-geek-400/10":"hover:bg-neutral-700/10 hover:text-neutral-200"}`,onClick:()=>{a.id==="logout"?B():o(a.id)},children:e.jsx("span",{className:"font-mono text-sm",children:a.label})},a.id))})}),e.jsxs("div",{className:"flex-1 p-6",children:[r==="profile"&&e.jsxs(c.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"relative group",onClick:z,children:[e.jsx("div",{className:"w-24 h-24 rounded-full bg-neutral-700 bg-cover bg-center",style:{backgroundImage:`url(${s.avatar})`}}),e.jsx("div",{className:`absolute inset-0 flex items-center justify-center\r
                                            bg-black/60 rounded-full opacity-0 group-hover:opacity-100 transition-opacity\r
                                            cursor-pointer`,children:e.jsx("span",{className:"text-neutral-200 text-sm font-mono",children:"CHANGE"})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-neutral-50 font-mono mb-1",children:s.name}),e.jsx("p",{className:"text-neutral-400 text-sm",children:s.emailVerified?"✓ Email verified":"⚠ Email not verified"})]})]}),e.jsxs("form",{onSubmit:a=>{a.preventDefault(),x({name:a.target.name.value,email:a.target.email.value,bio:a.target.bio.value})},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-neutral-400 text-sm mb-2",children:"Display Name"}),e.jsx("input",{name:"name",type:"text",defaultValue:s.name,className:`w-full p-3 bg-neutral-900 border border-neutral-300/30 rounded-md\r
                                                text-neutral-50 font-mono\r
                                                focus:outline-none focus:border-geek-400`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-neutral-400 text-sm mb-2",children:"Email"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{name:"email",type:"email",defaultValue:s.email,className:`flex-1 p-3 bg-neutral-900 border border-neutral-300/30 rounded-md\r
                                                    text-neutral-50 font-mono\r
                                                    focus:outline-none focus:border-geek-400`}),!s.emailVerified&&e.jsx(m,{variant:"primary",size:"sm",className:"border-yellow-400 text-yellow-400 hover:bg-yellow-400/10",onClick:()=>P(!0),children:"VERIFY"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-neutral-400 text-sm mb-2",children:"Bio"}),e.jsx("textarea",{name:"bio",defaultValue:s.bio,rows:4,className:`w-full p-3 bg-neutral-900 border border-neutral-300/30 rounded-md\r
                                                text-neutral-50\r
                                                focus:outline-none focus:border-geek-400`})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-neutral-300/30",children:e.jsx(m,{type:"submit",variant:"primary",size:"sm",children:"SAVE CHANGES"})})]})]}),r==="security"&&e.jsxs(c.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6",children:[e.jsxs("form",{onSubmit:U,className:"p-4 border border-neutral-300/30 rounded-md",children:[e.jsx("h3",{className:"text-neutral-50 font-mono mb-4",children:"Change Password"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("input",{name:"currentPassword",type:"password",placeholder:"Current password",value:i.currentPassword,onChange:N,onBlur:C,className:`w-full p-3 bg-neutral-900 border rounded-md
                                                    text-neutral-50 font-mono focus:outline-none transition-all duration-200
                                                    ${t.currentPassword?"border-red-400 focus:border-red-400 shadow-[0_0_10px_rgba(248,113,113,0.1)]":"border-neutral-300/30 focus:border-geek-400 focus:shadow-[0_0_15px_rgba(89,126,247,0.1)]"}`,required:!0}),e.jsx(c.div,{initial:{opacity:0,height:0},animate:{opacity:t.currentPassword?1:0,height:t.currentPassword?"auto":0},transition:{duration:.2},children:t.currentPassword&&e.jsx("p",{className:"mt-1 text-red-400 text-sm",children:t.currentPassword})})]}),e.jsxs("div",{children:[e.jsx("input",{name:"newPassword",type:"password",placeholder:"New password",value:i.newPassword,onChange:N,onBlur:C,className:`w-full p-3 bg-neutral-900 border rounded-md
                                                    text-neutral-50 font-mono focus:outline-none transition-all duration-200
                                                    ${t.newPassword?"border-red-400 focus:border-red-400 shadow-[0_0_10px_rgba(248,113,113,0.1)]":"border-neutral-300/30 focus:border-geek-400 focus:shadow-[0_0_15px_rgba(89,126,247,0.1)]"}`,required:!0}),e.jsx(c.div,{initial:{opacity:0,height:0},animate:{opacity:t.newPassword?1:0,height:t.newPassword?"auto":0},transition:{duration:.2},children:t.newPassword&&e.jsx("p",{className:"mt-1 text-red-400 text-sm",children:t.newPassword})})]}),e.jsxs("div",{children:[e.jsx("input",{name:"confirmPassword",type:"password",placeholder:"Confirm new password",value:i.confirmPassword,onChange:N,onBlur:C,className:`w-full p-3 bg-neutral-900 border rounded-md
                                                    text-neutral-50 font-mono focus:outline-none transition-all duration-200
                                                    ${t.confirmPassword?"border-red-400 focus:border-red-400 shadow-[0_0_10px_rgba(248,113,113,0.1)]":"border-neutral-300/30 focus:border-geek-400 focus:shadow-[0_0_15px_rgba(89,126,247,0.1)]"}`,required:!0}),e.jsx(c.div,{initial:{opacity:0,height:0},animate:{opacity:t.confirmPassword?1:0,height:t.confirmPassword?"auto":0},transition:{duration:.2},children:t.confirmPassword&&e.jsx("p",{className:"mt-1 text-red-400 text-sm",children:t.confirmPassword})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(m,{type:"submit",variant:"primary",size:"sm",children:"UPDATE PASSWORD"})})]})]}),e.jsxs("div",{className:"p-4 border border-red-400/30 rounded-md bg-red-400/5",children:[e.jsx("h3",{className:"text-red-400 font-mono mb-2",children:"Delete Account"}),e.jsx("p",{className:"text-neutral-400 text-sm mb-4",children:"Once you delete your account, there is no going back. Please be certain."}),e.jsx(m,{variant:"danger",size:"sm",onClick:()=>y(!0),children:"DELETE ACCOUNT"})]})]})]})]})]}),e.jsx(S,{isOpen:_,onClose:()=>y(!1),onConfirm:()=>{f(),y(!1)},title:"Delete Account",message:"Are you sure you want to delete your account? This action cannot be undone.",confirmText:"DELETE",type:"danger"}),e.jsx(S,{isOpen:D,onClose:()=>P(!1),onConfirm:()=>{p(s.email),P(!1)},title:"Verify Email",message:"We will send a verification link to your email address. Please check your inbox and follow the instructions.",confirmText:"SEND"})]})}function Y(){const{user:s,loading:x}=I(r=>r.user),h=A(),p=async r=>{try{await $(r),await h(E()),n.success({title:"个人信息更新成功"})}catch(o){n.danger({title:"更新失败",description:o.message})}},f=async r=>{try{const o=await q({old:r.currentPassword,new:r.newPassword});if(o.code!==200){n.danger({title:"密码修改失败",description:o.msg});return}n.success({title:"密码修改成功"})}catch(o){n.danger({title:"密码修改失败",description:o.message})}},w=async()=>{try{await R(),n.success({title:"验证邮件已发送",description:"请查看您的邮箱"})}catch(r){n.danger({title:"发送失败",description:r.message})}},b=async()=>{try{await F(),n.info({title:"账户已删除"})}catch(r){n.danger({title:"删除失败",description:r.message})}},j=async r=>{try{await G(r),await h(E()),n.success({title:"头像更新成功"})}catch(o){n.danger({title:"更新失败",description:o.message})}};return x||!s?e.jsx(M,{}):e.jsx(H,{user:{name:s.name||"",email:s.email||"",emailVerified:s.verified||!1,avatar:s.avatar||"https://avatars.githubusercontent.com/u/default",bio:s.desc||""},onUpdate:p,onPasswordChange:f,onEmailVerify:w,onDeleteAccount:b,onAvatarChange:j})}export{Y as default};
