import{r as m,j as e,m as o,B as h,A as j,u as v,a as _,s as g,f as N,t as P}from"./index-C2v50R19.js";import{l as k,r as S}from"./auth-HBDqE2Hx.js";function E({onSubmit:u}){const[s,d]=m.useState(!0),[a,n]=m.useState({username:"",password:"",confirmPassword:"",email:""}),[r,i]=m.useState({}),[f,b]=m.useState(!1),w=()=>{const t={};return a.username?a.username.length<3&&(t.username="Username must be at least 3 characters"):t.username="Username is required",a.password?a.password.length<6&&(t.password="Password must be at least 6 characters"):t.password="Password is required",s||(a.confirmPassword?a.confirmPassword!==a.password&&(t.confirmPassword="Passwords do not match"):t.confirmPassword="Please confirm your password",a.email?/\S+@\S+\.\S+/.test(a.email)||(t.email="Invalid email address"):t.email="Email is required"),i(t),Object.keys(t).length===0},y=async t=>{if(t.preventDefault(),!!w()){b(!0);try{await u({type:s?"login":"register",data:{username:a.username,password:a.password,...s?{}:{email:a.email,confirmPassword:a.confirmPassword}}})}catch(l){i(p=>({...p,submit:l.message}))}finally{b(!1)}}},c=t=>{const{name:l,value:p}=t.target;n(x=>({...x,[l]:p})),r[l]&&i(x=>({...x,[l]:""}))};return e.jsxs(o.form,{onSubmit:y,className:"w-[400px] bg-black/40 backdrop-blur-[2px] border border-neutral-300 rounded-md p-8",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.2},children:[e.jsxs("div",{className:"relative flex justify-center mb-8",children:[e.jsx("div",{className:"absolute -top-[3px] -right-[3px] w-[10px] h-[10px] border-t border-r border-neutral-300"}),e.jsx("div",{className:"absolute -bottom-[3px] -left-[3px] w-[10px] h-[10px] border-b border-l border-neutral-300"}),e.jsx(o.span,{className:"text-neutral-300 text-2xl font-mono tracking-wider",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15},children:s?"LOGIN":"REGISTER"},s?"login":"register")]}),e.jsxs("div",{className:"flex justify-center gap-4 mb-8",children:[e.jsx(h,{variant:s?"primary":"outline",size:"sm",className:"min-w-[100px]",onClick:()=>d(!0),children:"LOGIN"}),e.jsx(h,{variant:s?"outline":"primary",size:"sm",className:"min-w-[100px]",onClick:()=>d(!1),children:"REGISTER"})]}),e.jsxs(o.div,{className:"space-y-4",animate:{height:"auto"},transition:{duration:.2},children:[e.jsx(j,{mode:"wait",children:e.jsx(o.div,{initial:{opacity:0,x:s?-20:20},animate:{opacity:1,x:0},exit:{opacity:0,x:s?20:-20},transition:{duration:.2,ease:"easeOut"},children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("input",{type:"text",name:"username",value:a.username,onChange:c,placeholder:"Username",className:`
                                        w-full h-[40px] bg-black/20 border rounded-md px-4 
                                        text-neutral-50 placeholder-neutral-400
                                        transition-all duration-200
                                        ${r.username?"border-red-500 focus:border-red-500 focus:shadow-[0_0_15px_rgba(239,68,68,0.3)]":"border-neutral-300 focus:border-geek-400 focus:shadow-[0_0_15px_rgba(89,126,247,0.3)]"}
                                    `}),r.username&&e.jsx(o.span,{className:"text-red-500 text-xs mt-1 block",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.15},children:r.username})]}),!s&&e.jsxs(o.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.15,ease:"easeInOut"},children:[e.jsx("input",{type:"email",name:"email",value:a.email,onChange:c,placeholder:"Email",className:`
                                            w-full h-[40px] bg-black/20 border rounded-md px-4 
                                            text-neutral-50 placeholder-neutral-400
                                            transition-all duration-200
                                            ${r.email?"border-red-500 focus:border-red-500 focus:shadow-[0_0_15px_rgba(239,68,68,0.3)]":"border-neutral-300 focus:border-geek-400 focus:shadow-[0_0_15px_rgba(89,126,247,0.3)]"}
                                        `}),r.email&&e.jsx(o.span,{className:"text-red-500 text-xs mt-1 block",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:r.email})]}),e.jsxs("div",{children:[e.jsx("input",{type:"password",name:"password",value:a.password,onChange:c,placeholder:"Password",className:`
                                        w-full h-[40px] bg-black/20 border rounded-md px-4 
                                        text-neutral-50 placeholder-neutral-400
                                        transition-all duration-200
                                        ${r.password?"border-red-500 focus:border-red-500 focus:shadow-[0_0_15px_rgba(239,68,68,0.3)]":"border-neutral-300 focus:border-geek-400 focus:shadow-[0_0_15px_rgba(89,126,247,0.3)]"}
                                    `}),r.password&&e.jsx("span",{className:"text-red-500 text-xs mt-1 block",children:r.password})]}),!s&&e.jsxs(o.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.15,ease:"easeInOut"},children:[e.jsx("input",{type:"password",name:"confirmPassword",value:a.confirmPassword,onChange:c,placeholder:"Confirm Password",className:`
                                            w-full h-[40px] bg-black/20 border rounded-md px-4 
                                            text-neutral-50 placeholder-neutral-400
                                            transition-all duration-200
                                            ${r.confirmPassword?"border-red-500 focus:border-red-500 focus:shadow-[0_0_15px_rgba(239,68,68,0.3)]":"border-neutral-300 focus:border-geek-400 focus:shadow-[0_0_15px_rgba(89,126,247,0.3)]"}
                                        `}),r.confirmPassword&&e.jsx(o.span,{className:"text-red-500 text-xs mt-1 block",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:r.confirmPassword})]})]})},s?"login-form":"register-form")}),e.jsx(h,{type:"submit",variant:"primary",fullWidth:!0,className:"shadow-[0_0_20px_rgba(89,126,247,0.4)]",disabled:f,children:f?"Processing...":s?"LOGIN":"REGISTER"})]})]})}function L(){const u=v(),s=_(),d=async({type:a,data:n})=>{const r=(a==="login"?"登录":"注册")+"失败";try{let i;s(g({effect:a,loading:!0})),a==="login"?i=await k({name:n.username,password:n.password}):i=await S({name:n.username,email:n.email,password:n.password}),i.code===200&&(await s(N()),u("/games"))}catch(i){throw console.error(`${a} failed:`,i.message),P.danger({title:r,description:i.message}),i}finally{s(g({effect:a,loading:!1}))}};return e.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-190px)]",children:e.jsx(E,{onSubmit:d})})}export{L as default};
